clear;clc;close all
% Crack data
crack_data{1} = [0, 0.47, 0.93, 2.11, 2.72, 3.51, 4.34, 4.91, 5.48, 5.99, 6.72, 7.13, 8.00, 8.92, 9.49, 9.87, 10.94];
crack_data{2} = [0, 0.71, 1.22, 1.90, 2.30, 2.87, 3.75, 4.42, 4.99, 5.51, 6.07, 6.64, 7.16, 7.78, 8.42, 8.91, 9.28];
crack_data{3} = [0, 0.36, 1.39, 1.95, 2.86, 3.46, 3.81, 4.53, 5.35, 5.92, 6.71, 7.70, 8.61, 9.15, 9.95, 10.49, 11.01];
crack_data{4} = [0, 0.41, 1.49, 2.38, 3.00, 3.84, 4.50, 5.25, 6.26, 7.05, 7.80, 8.32, 8.93, 9.55, 10.45, 11.28, 12.21];

crack_data{5} = [0, 0.71, 1.17, 1.73, 1.99, 2.53, 2.97, 3.30, 3.94, 4.16, 4.45, 4.89, 5.27, 5.69, 6.02, 6.45, 6.88];
crack_data{6} = [0, 0.36, 0.62, 1.36, 1.95, 2.30, 2.95, 3.39, 3.79, 4.11, 4.50, 4.72, 4.98, 5.28, 5.61, 5.95, 6.14];
crack_data{7} = [0, 0.27, 0.61, 1.11, 1.77, 2.06, 2.58, 2.99, 3.38, 4.05, 4.63, 5.24, 5.62, 6.04, 6.32, 7.10, 7.59];
crack_data{8} = [0, 0.36, 0.92, 1.21, 1.46, 1.93, 2.39, 2.68, 2.94, 3.42, 4.09, 4.58, 4.84, 5.11, 5.57, 6.11, 7.17];
crack_data{9} = [0, 0.46, 1.07, 1.42, 1.77, 2.11, 2.40, 2.78, 3.02, 3.29, 3.75, 4.16, 4.76, 5.16, 5.46, 5.81, 6.24];
crack_data{10} = [0, 0.51, 0.93, 1.57, 1.96, 2.59, 3.29, 3.61, 4.11, 4.60, 4.91, 5.34, 5.84, 6.40, 6.84, 7.20, 7.88];
crack_data{11} = [0, 0.44, 1.00, 1.57, 1.96, 2.51, 2.84, 3.47, 4.01, 4.51, 4.80, 5.20, 5.66, 6.20, 6.54, 6.96, 7.42];
crack_data{12} = [0, 0.39, 0.80, 1.35, 1.74, 2.98, 3.59, 4.03, 4.44, 4.79, 5.22, 5.48, 5.96, 6.23, 6.23, 6.99, 7.88];
crack_data{13} = [0, 0.44, 0.70, 1.05, 1.35, 1.80, 2.55, 2.83, 3.39, 3.72, 4.09, 4.83, 5.41, 5.76, 6.14, 6.51, 6.88];
crack_data{14} = [0, 0.51, 0.83, 1.29, 1.52, 1.91, 2.27, 2.78, 3.42, 3.78, 4.11, 4.38, 4.63, 5.38, 5.84, 6.16, 6.62];

% 目标值
target_value = 9;

% 初始化结果
fprintf('Sample Index\tTime to reach %.2f\n', target_value);
fprintf('-------------\t---------------------\n');

for i = 1:4
    y = crack_data{i};
    x = 0:length(y)-1;  % 假设每个值间隔为1个时间单位

    % 找到y中首次大于等于1.6的位置
    idx = find(y >= target_value, 1);

    if isempty(idx)
        fprintf('%d\t\tNot reached\n', i);
        continue;
    elseif idx == 1
        % 第一个点就已经超过，不插值
        t_interp = x(1);
    else
        % 线性插值计算达到1.6的时间
        x1 = x(idx-1);
        x2 = x(idx);
        y1 = y(idx-1);
        y2 = y(idx);

        t_interp = x1 + (target_value - y1) * (x2 - x1) / (y2 - y1);
    end

    fprintf('%d\t\t%.4f\n', i, t_interp*250);
end
%% 
% 新的目标值
target_value = 6;

fprintf('\nSample Index\tTime to reach %.2f\n', target_value);
fprintf('-------------\t---------------------\n');

for i = 5:14
    y = crack_data{i};
    x = 0:length(y)-1;  % 每个数据点时间间隔为1

    % 查找第一次超过或等于目标值的位置
    idx = find(y >= target_value, 1);

    if isempty(idx)
        fprintf('%d\t\tNot reached\n', i);
        continue;
    elseif idx == 1
        t_interp = x(1);
    else
        x1 = x(idx-1);
        x2 = x(idx);
        y1 = y(idx-1);
        y2 = y(idx);

        % 线性插值
        t_interp = x1 + (target_value - y1) * (x2 - x1) / (y2 - y1);
    end

    fprintf('%d\t\t%.4f\n', i, t_interp*250);
end

